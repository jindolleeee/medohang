<!DOCTYPE html>
<html lang="ko">
<head>
    <link rel="stylesheet" href="style.css">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Mehang</title>
    <style>
        #map {
            height: 90vh;
            width: 100%;
        }
        h1 {
            text-align: center;
            font-family: sans-serif;
        }
    </style>
</head>
<body>
    <h1>ÎØ∏ÎèÑÌñâ</h1>
    <div id="map"></div>

    <script>
        function initMap() {
            const colorToPlaceType = {
                red: 'art_gallery',         // Ïó¥Ï†ï ‚Üí Í∞§Îü¨Î¶¨
                blue: 'natural_feature',    // Í≥†ÏöîÌï® ‚Üí ÏûêÏó∞
                pink: 'spa',                // Í∞êÏÑ± ‚Üí ÌûêÎßÅ
                yellow: 'tourist_attraction', // Î∞ùÏùå ‚Üí Î™ÖÏÜå
                black: 'museum',            // ÍπäÏù¥ ‚Üí Î∞ïÎ¨ºÍ¥Ä
                white: 'church'             // Ï†ïÏ†Å ‚Üí Ï¢ÖÍµê Í≥µÍ∞Ñ
            };

            const locations = [
                {
                    position: { lat: 38.9067339, lng: 1.4205983},
                    title: 'Ïù¥ÎπÑÏûê (Bali Center)',
                    color: 'red',
                },
                {
                    position: { lat: 25.3463, lng: 55.4209 },
                    title: 'ÏÉ§Î•¥Ïûê (Sharjah)',
                    color: 'red',
                },
                {
                    position: { lat: 40.6943, lng: -73.9249 },
                    title: 'Îâ¥Ïöï (New York)',
                    color: 'red',
                },
            ];

            const map = new google.maps.Map(document.getElementById("map"), {
                zoom: 2,
                center: { lat: 0, lng: 0 },
            });

            const service = new google.maps.places.PlacesService(map);

            locations.forEach((location) => {
                const marker = new google.maps.Marker({
                    position: location.position,
                    map: map,
                    title: location.title,
                    icon: {
                        path: google.maps.SymbolPath.CIRCLE,
                        fillColor: location.color,
                        fillOpacity: 1,
                        strokeColor: 'white',
                        strokeWeight: 2,
                        scale: 10,
                    },
                });

                const infoWindow = new google.maps.InfoWindow({
                    content: `<h3>${location.title}</h3><p>Loading nearby places...</p>`,
                });

                marker.addListener('click', () => {
                    map.setZoom(12);
                    map.setCenter(marker.getPosition());

                    let placesList = `<h3>${location.title}</h3>`;

                    // 1. ÏãùÎãπ Í≤ÄÏÉâ
                    service.nearbySearch(
                        {
                            location: location.position,
                            radius: 5000,
                            type: 'restaurant',
                        },
                        (results, status) => {
                            if (status === google.maps.places.PlacesServiceStatus.OK) {
                                const filtered = results.filter(p => p.types.includes('restaurant'));
                                placesList += '<h4>üçΩÔ∏è Top Restaurants</h4><ul>';
                                filtered.slice(0, 5).forEach(place => {
                                    placesList += `<li>${place.name} (${place.rating?.toFixed(1) || 'N/A'}‚≠ê)</li>`;
                                    new google.maps.Marker({
                                        position: place.geometry.location,
                                        map: map,
                                        title: place.name,
                                        icon: {
                                            path: google.maps.SymbolPath.CIRCLE,
                                            fillColor: 'green',
                                            fillOpacity: 1,
                                            strokeColor: 'white',
                                            strokeWeight: 2,
                                            scale: 8,
                                        },
                                    });
                                });
                                placesList += '</ul>';
                            } else {
                                placesList += '<h4>No restaurants found.</h4>';
                            }

                            // 2. ÏàôÏÜå Í≤ÄÏÉâ
                            service.nearbySearch(
                                {
                                    location: location.position,
                                    radius: 5000,
                                    type: 'lodging',
                                },
                                (lodgingResults, lodgingStatus) => {
                                    if (lodgingStatus === google.maps.places.PlacesServiceStatus.OK) {
                                        placesList += '<h4>üè® Top Lodgings</h4><ul>';
                                        lodgingResults.slice(0, 5).forEach(place => {
                                            placesList += `<li>${place.name} (${place.rating?.toFixed(1) || 'N/A'}‚≠ê)</li>`;
                                            new google.maps.Marker({
                                                position: place.geometry.location,
                                                map: map,
                                                title: place.name,
                                                icon: {
                                                    path: google.maps.SymbolPath.CIRCLE,
                                                    fillColor: 'yellow',
                                                    fillOpacity: 1,
                                                    strokeColor: 'white',
                                                    strokeWeight: 2,
                                                    scale: 8,
                                                },
                                            });
                                        });
                                        placesList += '</ul>';
                                    } else {
                                        placesList += '<h4>No lodgings found.</h4>';
                                    }

                                    // 3. ÏÉâÏÉÅ Í∏∞Î∞ò Ï∂îÏ≤ú Ïû•ÏÜå Í≤ÄÏÉâ
                                    const extraType = colorToPlaceType[location.color];
                                    if (extraType) {
                                        service.nearbySearch(
                                            {
                                                location: location.position,
                                                radius: 5000,
                                                type: extraType,
                                            },
                                            (extraResults, extraStatus) => {
                                                if (extraStatus === google.maps.places.PlacesServiceStatus.OK) {
                                                    placesList += '<h4>üåà Recommended Places</h4><ul>';
                                                    extraResults.slice(0, 5).forEach(place => {
                                                        placesList += `<li>${place.name} (${place.rating?.toFixed(1) || 'N/A'}‚≠ê)</li>`;
                                                        new google.maps.Marker({
                                                            position: place.geometry.location,
                                                            map: map,
                                                            title: place.name,
                                                            icon: {
                                                                path: google.maps.SymbolPath.CIRCLE,
                                                                fillColor: 'purple',
                                                                fillOpacity: 1,
                                                                strokeColor: 'white',
                                                                strokeWeight: 2,
                                                                scale: 8,
                                                            },
                                                        });
                                                    });
                                                    placesList += '</ul>';
                                                } else {
                                                    placesList += `<h4>No additional places found for ${extraType}.</h4>`;
                                                }

                                                // ÏµúÏ¢Ö Ï†ïÎ≥¥Ï∞Ω ÏóÖÎç∞Ïù¥Ìä∏
                                                infoWindow.setContent(placesList);
                                                infoWindow.open(map, marker);
                                            }
                                        );
                                    } else {
                                        infoWindow.setContent(placesList);
                                        infoWindow.open(map, marker);
                                    }
                                }
                            );
                        }
                    );
                });
            });
        }
    </script>
    

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCNmXZlxFDRL4G8iKEgMrQ-ryzR_D0faTE&libraries=places" async defer onload="initMap()"></script>
</body>
</html>
